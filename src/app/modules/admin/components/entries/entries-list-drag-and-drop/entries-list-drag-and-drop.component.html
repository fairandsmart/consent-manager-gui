<!--
  #%L
  Right Consents, a Universal Consents & Preferences Management Platform.
  %%
  Copyright (C) 2020 - 2021 Fair And Smart
  %%
  This file is part of Right Consents Community Edition.

  Right Consents Community Edition is published by FAIR AND SMART under the
  GNU GENERAL PUBLIC LICENCE Version 3 (GPLv3) and a set of additional terms.

  For more information, please see the “LICENSE” and “LICENSE.FAIRANDSMART”
  files, or see https://www.fairandsmart.com/opensource/.
  #L%
  -->
<ng-container *ngIf="(section.dataSource.connect() | async) as entries">
  <div class="section-toolbar">
    <div></div>
    <div *ngIf="section.showSort && entries.length > 0 && section.orderingOptions.length > 0" class="sort-actions">
      <button mat-button
              [matMenuTriggerFor]="orderMenu">{{'ENTRIES.COMMON.' + section.filter.order + '.LABEL' | translate}}</button>
      <mat-menu #orderMenu>
        <ng-template matMenuContent>
          <button mat-menu-item *ngFor="let option of section.orderingOptions"
                  [disabled]="section.filter.order === option"
                  (click)="sortBy(option, section)">{{'ENTRIES.COMMON.' + option + '.LABEL' | translate}}</button>
        </ng-template>
      </mat-menu>
      <button (click)="toggleDirection(section)" mat-icon-button>
        <mat-icon>{{section.filter.direction === 'asc' ? 'arrow_upward' : 'arrow_downward'}}</mat-icon>
      </button>
    </div>
  </div>
  <div cdkDropList
       [id]="'available-' + section.id"
       [cdkDropListConnectedTo]="['selected-' + (section.listId ? section.listId : section.id)]"
       [cdkDropListData]="entries"
       cdkDropListSortingDisabled
       class="elements-list"
       (cdkDropListDropped)="drop($event)">
    <mat-grid-list *ngIf="entries.length > 0" [cols]="section.columns" gutterSize="10" rowHeight="80"
                   [class.loading]="section.dataSource.loading$ | async">
      <mat-grid-tile *ngFor="let entry of entries">
        <cm-entry-card cdkDrag [cdkDragData]="entry"
                       [selected]="isSelected(entry)"
                       [cdkDragDisabled]="isDisabled(entry)"
                       [matTooltip]="notDraggableReason(entry) | translate"
                       [entry]="entry"
                       [showKey]="showKeys"></cm-entry-card>
      </mat-grid-tile>
    </mat-grid-list>
    <p *ngIf="entries.length === 0" class="empty-hint">{{'ENTRIES.COMMON.EMPTY_LIST' | translate}}</p>
  </div>
</ng-container>
<mat-paginator [class.single-page]="paginator.pageIndex === 0 && !paginator.hasNextPage()"
               #paginator="matPaginator" [hidePageSize]="true" [pageIndex]="section.filter.page"
               [pageSize]="section.filter.size"></mat-paginator>
